<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FRZZR</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .add-form {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }

        .form-row {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr auto;
            gap: 15px;
            align-items: end;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .add-btn {
            padding: 12px 24px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s ease;
            height: fit-content;
        }

        .add-btn:hover {
            background: #5a67d8;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #666;
            font-weight: 500;
        }

        .items-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }

        .item-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .item-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.15);
        }

        .item-header {
            display: flex;
            justify-content: between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .item-name {
            font-size: 1.2em;
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }

        .item-category {
            background: #667eea;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            font-weight: 500;
        }

        .item-details {
            color: #666;
            margin-bottom: 15px;
        }

        .days-left {
            font-weight: 600;
            padding: 8px 12px;
            border-radius: 6px;
            text-align: center;
            margin-bottom: 15px;
        }

        .fresh { background: #d4edda; color: #155724; }
        .warning { background: #fff3cd; color: #856404; }
        .expired { background: #f8d7da; color: #721c24; }

        .delete-btn {
            width: 100%;
            padding: 10px;
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: background 0.3s ease;
        }

        .delete-btn:hover {
            background: #c82333;
        }

        .scan-btn {
            width: 100%;
            padding: 15px;
            background: #28a745;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .scan-btn:hover {
            background: #218838;
        }

        .scan-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }

        #scannerContainer {
            text-align: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .lookup-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .lookup-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .lookup-loading {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .empty-state {
            text-align: center;
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.2em;
            padding: 60px 20px;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üßä FRZZR</h1>
            <p>Keep track of what's in your freezer and never waste food again!</p>
        </div>

        <div class="add-form">
            <div class="scan-section" style="margin-bottom: 20px;">
                <div class="scan-buttons" style="display: grid; grid-template-columns: 1fr 1fr auto; gap: 10px; margin-bottom: 15px;">
                    <button class="scan-btn" id="scanBtn" onclick="toggleScanner()">
                        üì± Scan Barcode
                    </button>
                    <button class="scan-btn" id="batchBtn" onclick="toggleBatchMode()" style="background: #fd7e14;">
                        üì¶ Batch Scan
                    </button>
                    <button class="scan-btn" onclick="toggleManualEntry()" style="background: #6f42c1; min-width: 120px;">
                        ‚å®Ô∏è Manual Entry
                    </button>
                </div>
                
                <div id="manualEntry" style="display: none; margin-bottom: 15px;">
                    <div style="display: flex; gap: 10px;">
                        <input type="text" id="manualBarcode" placeholder="Enter barcode number..." style="flex: 1; padding: 10px; border: 2px solid #e1e5e9; border-radius: 6px; font-size: 16px;">
                        <button onclick="lookupManualBarcode()" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 500;">Lookup</button>
                    </div>
                </div>

                <div id="batchQueue" style="display: none; margin-bottom: 15px;">
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border: 2px dashed #dee2e6;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <strong>Batch Mode - Items in Queue: <span id="batchCount">0</span></strong>
                            <div>
                                <button onclick="addAllBatchItems()" style="padding: 6px 12px; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer; margin-right: 5px;">Add All</button>
                                <button onclick="clearBatchQueue()" style="padding: 6px 12px; background: #dc3545; color: white; border: none; border-radius: 4px; cursor: pointer;">Clear Queue</button>
                            </div>
                        </div>
                        <div id="batchItems" style="max-height: 200px; overflow-y: auto;"></div>
                    </div>
                </div>

                <div id="scannerContainer" style="display: none; margin-top: 15px;">
                    <div style="position: relative; display: inline-block;">
                        <video id="video" autoplay muted playsinline style="width: 100%; max-width: 400px; border-radius: 8px; display: block;"></video>
                        <canvas id="canvas" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;"></canvas>
                        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); border: 2px solid #ff0000; width: 200px; height: 100px; border-radius: 8px; pointer-events: none; box-shadow: 0 0 0 9999px rgba(0,0,0,0.3);"></div>
                    </div>
                    <div style="margin-top: 10px; text-align: center;">
                        <button onclick="stopScanner()" style="padding: 8px 16px; background: #dc3545; color: white; border: none; border-radius: 4px; cursor: pointer;">Stop Scanning</button>
                        <span id="scanMode" style="margin-left: 15px; font-weight: 500;"></span>
                    </div>
                </div>
                <div id="lookupStatus" style="margin-top: 10px; padding: 10px; border-radius: 6px; display: none;"></div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="itemName">Item Name</label>
                    <input type="text" id="itemName" placeholder="e.g., Ground beef, Ice cream... or scan barcode above" required>
                </div>
                <div class="form-group">
                    <label for="category">Category</label>
                    <select id="category">
                        <option value="Meat">Meat</option>
                        <option value="Vegetables">Vegetables</option>
                        <option value="Dairy">Dairy</option>
                        <option value="Desserts">Desserts</option>
                        <option value="Prepared">Prepared Foods</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="frozenDate">Date Frozen</label>
                    <input type="date" id="frozenDate" required>
                </div>
                <button class="add-btn" onclick="addItem()">Add Item</button>
            </div>
        </div>

        <div class="stats" id="stats">
            <div class="stat-card">
                <div class="stat-number" id="totalItems">0</div>
                <div class="stat-label">Total Items</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="expiringSoon">0</div>
                <div class="stat-label">Use Soon</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="oldestDays">0</div>
                <div class="stat-label">Oldest Item (days)</div>
            </div>
        </div>

        <div class="items-grid" id="itemsGrid">
            <div class="empty-state">
                Your freezer is empty! Add some items to get started.
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/quagga/0.12.1/quagga.min.js"></script>
    <script>
        let freezerItems = [];
        let isScanning = false;
        let isBatchMode = false;
        let batchQueue = [];

        // Set today's date as default
        document.getElementById('frozenDate').valueAsDate = new Date();

        // Freezer storage guidelines (months)
        const storageGuidelines = {
            'Meat': 6,
            'Vegetables': 12,
            'Dairy': 3,
            'Desserts': 4,
            'Prepared': 3,
            'Other': 6
        };

        function addItem() {
            const name = document.getElementById('itemName').value.trim();
            const category = document.getElementById('category').value;
            const frozenDate = document.getElementById('frozenDate').value;

            if (!name || !frozenDate) {
                alert('Please fill in all fields!');
                return;
            }

            // Fix timezone issue by creating date in local timezone
            const dateParts = frozenDate.split('-');
            const localDate = new Date(dateParts[0], dateParts[1] - 1, dateParts[2]);

            const item = {
                id: Date.now(),
                name: name,
                category: category,
                frozenDate: localDate,
                addedDate: new Date()
            };

            freezerItems.push(item);
            
            // Clear form
            document.getElementById('itemName').value = '';
            document.getElementById('frozenDate').valueAsDate = new Date();

            updateDisplay();
        }

        function deleteItem(id) {
            freezerItems = freezerItems.filter(item => item.id !== id);
            updateDisplay();
        }

        function getDaysInFreezer(frozenDate) {
            const now = new Date();
            const diffTime = Math.abs(now - frozenDate);
            return Math.ceil(diffTime / (1000 * 60 * 60 * 24));
        }

        function getItemStatus(item) {
            const daysInFreezer = getDaysInFreezer(item.frozenDate);
            const maxDays = storageGuidelines[item.category] * 30; // Convert months to days
            const warningDays = maxDays * 0.8; // 80% of max storage time

            if (daysInFreezer >= maxDays) {
                return { status: 'expired', daysLeft: 0, message: 'Use immediately!' };
            } else if (daysInFreezer >= warningDays) {
                return { status: 'warning', daysLeft: maxDays - daysInFreezer, message: `Use within ${maxDays - daysInFreezer} days` };
            } else {
                return { status: 'fresh', daysLeft: maxDays - daysInFreezer, message: `Good for ${maxDays - daysInFreezer} more days` };
            }
        }

        function updateStats() {
            const total = freezerItems.length;
            let expiringSoon = 0;
            let oldestDays = 0;

            freezerItems.forEach(item => {
                const status = getItemStatus(item);
                if (status.status === 'warning' || status.status === 'expired') {
                    expiringSoon++;
                }
                const daysInFreezer = getDaysInFreezer(item.frozenDate);
                if (daysInFreezer > oldestDays) {
                    oldestDays = daysInFreezer;
                }
            });

            document.getElementById('totalItems').textContent = total;
            document.getElementById('expiringSoon').textContent = expiringSoon;
            document.getElementById('oldestDays').textContent = oldestDays;
        }

        function updateDisplay() {
            const grid = document.getElementById('itemsGrid');
            
            if (freezerItems.length === 0) {
                grid.innerHTML = '<div class="empty-state">Your freezer is empty! Add some items to get started.</div>';
                updateStats();
                return;
            }

            // Sort by status (expired first, then warning, then fresh)
            const sortedItems = [...freezerItems].sort((a, b) => {
                const statusA = getItemStatus(a);
                const statusB = getItemStatus(b);
                const statusOrder = { expired: 0, warning: 1, fresh: 2 };
                return statusOrder[statusA.status] - statusOrder[statusB.status];
            });

            grid.innerHTML = sortedItems.map(item => {
                const status = getItemStatus(item);
                const daysInFreezer = getDaysInFreezer(item.frozenDate);
                
                return `
                    <div class="item-card">
                        <div class="item-header">
                            <div>
                                <div class="item-name">${item.name}</div>
                                <div class="item-category">${item.category}</div>
                            </div>
                        </div>
                        <div class="item-details">
                            Frozen: ${item.frozenDate.toLocaleDateString()}<br>
                            In freezer: ${daysInFreezer} days
                        </div>
                        <div class="days-left ${status.status}">
                            ${status.message}
                        </div>
                        <button class="delete-btn" onclick="deleteItem(${item.id})">Remove</button>
                    </div>
                `;
            }).join('');

            updateStats();
        }

        // Handle Enter key in item name input
        document.getElementById('itemName').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                addItem();
            }
        });

        // Handle Enter key in manual barcode input
        document.getElementById('manualBarcode').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                lookupManualBarcode();
            }
        });

        // Initial display update
        updateDisplay();

        // Barcode scanning functions
        function toggleScanner() {
            if (isScanning) {
                stopScanner();
            } else {
                isBatchMode = false;
                startScanner();
            }
        }

        function toggleBatchMode() {
            if (isScanning && isBatchMode) {
                stopScanner();
            } else {
                isBatchMode = true;
                document.getElementById('batchQueue').style.display = 'block';
                startScanner();
            }
        }

        function toggleManualEntry() {
            const manualEntry = document.getElementById('manualEntry');
            const isVisible = manualEntry.style.display !== 'none';
            manualEntry.style.display = isVisible ? 'none' : 'block';
            
            if (!isVisible) {
                document.getElementById('manualBarcode').focus();
            }
        }

        function lookupManualBarcode() {
            const barcode = document.getElementById('manualBarcode').value.trim();
            if (!barcode) {
                showLookupStatus('Please enter a barcode', 'error');
                return;
            }
            
            if (isBatchMode) {
                addToBatchQueue(barcode, 'Manual Entry');
                document.getElementById('manualBarcode').value = '';
            } else {
                lookupProduct(barcode);
                document.getElementById('manualBarcode').value = '';
            }
        }

        function addToBatchQueue(barcode, productName = null, category = null) {
            // Check if already in queue
            if (batchQueue.find(item => item.barcode === barcode)) {
                showLookupStatus('Item already in batch queue', 'error');
                return;
            }

            const batchItem = {
                id: Date.now(),
                barcode: barcode,
                name: productName || `Product ${barcode}`,
                category: category || 'Other',
                status: 'pending'
            };

            batchQueue.push(batchItem);
            updateBatchDisplay();
            
            // If we don't have product info, try to look it up
            if (!productName) {
                lookupProductForBatch(barcode, batchItem.id);
            }
        }

        function updateBatchDisplay() {
            const batchCount = document.getElementById('batchCount');
            const batchItems = document.getElementById('batchItems');
            
            batchCount.textContent = batchQueue.length;
            
            if (batchQueue.length === 0) {
                batchItems.innerHTML = '<div style="text-align: center; color: #666; padding: 20px;">No items in queue</div>';
                return;
            }

            batchItems.innerHTML = batchQueue.map(item => `
                <div class="batch-item">
                    <div class="batch-item-info">
                        <div class="batch-item-name">${item.name}</div>
                        <div class="batch-item-details">${item.category} ‚Ä¢ ${item.barcode} ${item.status === 'loading' ? '(looking up...)' : ''}</div>
                    </div>
                    <button class="batch-remove" onclick="removeFromBatch(${item.id})">Remove</button>
                </div>
            `).join('');
        }

        function removeFromBatch(id) {
            batchQueue = batchQueue.filter(item => item.id !== id);
            updateBatchDisplay();
        }

        function clearBatchQueue() {
            batchQueue = [];
            updateBatchDisplay();
        }

        function addAllBatchItems() {
            if (batchQueue.length === 0) {
                showLookupStatus('No items in batch queue', 'error');
                return;
            }

            // Get the frozen date from form or use today
            const frozenDateInput = document.getElementById('frozenDate').value;
            let frozenDate;
            
            if (frozenDateInput) {
                // Fix timezone issue by creating date in local timezone
                const dateParts = frozenDateInput.split('-');
                frozenDate = new Date(dateParts[0], dateParts[1] - 1, dateParts[2]);
            } else {
                frozenDate = new Date();
            }

            let addedCount = 0;

            batchQueue.forEach(batchItem => {
                const item = {
                    id: Date.now() + Math.random(), // Ensure unique IDs
                    name: batchItem.name,
                    category: batchItem.category,
                    frozenDate: frozenDate,
                    addedDate: new Date()
                };
                
                freezerItems.push(item);
                addedCount++;
            });

            clearBatchQueue();
            updateDisplay();
            showLookupStatus(`Added ${addedCount} items to freezer!`, 'success');
            
            // Hide batch queue if not in batch mode
            if (!isBatchMode) {
                document.getElementById('batchQueue').style.display = 'none';
            }
        }

        async function lookupProductForBatch(barcode, batchId) {
            // Update status to loading
            const batchItem = batchQueue.find(item => item.id === batchId);
            if (batchItem) {
                batchItem.status = 'loading';
                updateBatchDisplay();
            }

            try {
                const productInfo = await lookupProductInfo(barcode);
                
                const batchItemIndex = batchQueue.findIndex(item => item.id === batchId);
                if (batchItemIndex !== -1 && productInfo) {
                    batchQueue[batchItemIndex].name = productInfo.name;
                    batchQueue[batchItemIndex].category = productInfo.category;
                    batchQueue[batchItemIndex].status = 'found';
                } else if (batchItemIndex !== -1) {
                    batchQueue[batchItemIndex].status = 'not_found';
                }
                
                updateBatchDisplay();
            } catch (error) {
                const batchItemIndex = batchQueue.findIndex(item => item.id === batchId);
                if (batchItemIndex !== -1) {
                    batchQueue[batchItemIndex].status = 'error';
                    updateBatchDisplay();
                }
            }
        }

        function startScanner() {
            const scanBtn = document.getElementById('scanBtn');
            const batchBtn = document.getElementById('batchBtn');
            const scannerContainer = document.getElementById('scannerContainer');
            const scanMode = document.getElementById('scanMode');
            
            // Check if camera is supported
            if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
                showLookupStatus('Camera not supported on this device', 'error');
                return;
            }

            scanBtn.textContent = 'Starting camera...';
            scanBtn.disabled = true;
            batchBtn.disabled = true;
            scannerContainer.style.display = 'block';
            isScanning = true;

            // Show current mode
            scanMode.textContent = isBatchMode ? 'Batch Mode: Keep scanning items' : 'Single Mode: Will stop after first scan';
            
            if (isBatchMode) {
                document.getElementById('batchQueue').style.display = 'block';
            }

            Quagga.init({
                inputStream: {
                    name: "Live",
                    type: "LiveStream",
                    target: document.querySelector('#video'),
                    constraints: {
                        width: { ideal: 640 },
                        height: { ideal: 480 },
                        facingMode: "environment" // Use back camera if available
                    }
                },
                locator: {
                    patchSize: "medium",
                    halfSample: true
                },
                numOfWorkers: 2,
                frequency: 10,
                decoder: {
                    readers: [
                        "code_128_reader",
                        "ean_reader",
                        "ean_8_reader",
                        "code_39_reader"
                    ]
                },
                locate: true
            }, function(err) {
                if (err) {
                    console.log(err);
                    showLookupStatus('Camera access denied or not available', 'error');
                    stopScanner();
                    return;
                }
                
                scanBtn.textContent = isBatchMode ? 'üõë Stop Batch' : 'üõë Stop Scan';
                batchBtn.textContent = isBatchMode ? 'üì¶ Batch Mode' : 'üì¶ Batch Scan';
                Quagga.start();
            });

            Quagga.onDetected(function(data) {
                const code = data.codeResult.code;
                console.log('Barcode detected:', code);
                
                if (isBatchMode) {
                    // In batch mode, add to queue and keep scanning
                    addToBatchQueue(code);
                    showLookupStatus(`Added ${code} to batch queue`, 'success');
                } else {
                    // In single mode, stop scanning and look up
                    stopScanner();
                    lookupProduct(code);
                }
            });
        }

        function stopScanner() {
            if (isScanning) {
                Quagga.stop();
                isScanning = false;
                isBatchMode = false;
            }
            
            const scanBtn = document.getElementById('scanBtn');
            const batchBtn = document.getElementById('batchBtn');
            const scannerContainer = document.getElementById('scannerContainer');
            
            scanBtn.textContent = 'üì± Scan Barcode';
            scanBtn.disabled = false;
            batchBtn.textContent = 'üì¶ Batch Scan';
            batchBtn.disabled = false;
            scannerContainer.style.display = 'none';
        }

        async function lookupProduct(barcode) {
            showLookupStatus('Looking up product...', 'loading');
            
            const productInfo = await lookupProductInfo(barcode);
            
            if (productInfo) {
                // Auto-fill the form
                document.getElementById('itemName').value = productInfo.name;
                document.getElementById('category').value = productInfo.category;
                showLookupStatus(`Found: ${productInfo.name}`, 'success');
            } else {
                // If lookup fails, just fill in the barcode
                document.getElementById('itemName').value = `Product ${barcode}`;
                showLookupStatus('Product not found in database, but barcode captured', 'error');
            }
        }

        async function lookupProductInfo(barcode) {
            try {
                // Try OpenFoodFacts API first
                let response = await fetch(`https://world.openfoodfacts.org/api/v0/product/${barcode}.json`);
                let data = await response.json();
                
                if (data.status === 1 && data.product) {
                    const product = data.product;
                    const productName = product.product_name || product.product_name_en || 'Unknown Product';
                    
                    // Try to guess category based on categories
                    let category = 'Other';
                    if (product.categories) {
                        category = guessCategory(product.categories.toLowerCase()) || 'Other';
                    }
                    
                    return { name: productName, category: category };
                }
                
                // If OpenFoodFacts fails, try UPC Database
                response = await fetch(`https://api.upcitemdb.com/prod/trial/lookup?upc=${barcode}`);
                data = await response.json();
                
                if (data.code === 'OK' && data.items && data.items.length > 0) {
                    const item = data.items[0];
                    const productName = item.title || 'Unknown Product';
                    
                    // Try to guess category from title
                    let category = 'Other';
                    if (item.category) {
                        category = guessCategory(item.category.toLowerCase()) || 'Other';
                    }
                    
                    return { name: productName, category: category };
                }
                
                return null;
                
            } catch (error) {
                console.error('Lookup error:', error);
                return null;
            }
        }

        function guessCategory(text) {
            const categoryKeywords = {
                'Meat': ['meat', 'beef', 'chicken', 'pork', 'turkey', 'fish', 'salmon', 'tuna', 'bacon', 'sausage'],
                'Vegetables': ['vegetables', 'broccoli', 'spinach', 'carrots', 'peas', 'corn', 'beans', 'potato'],
                'Dairy': ['milk', 'cheese', 'yogurt', 'butter', 'cream', 'dairy'],
                'Desserts': ['ice cream', 'frozen yogurt', 'dessert', 'cake', 'cookie', 'chocolate'],
                'Prepared': ['pizza', 'meal', 'dinner', 'lunch', 'prepared', 'frozen meal', 'burrito', 'sandwich']
            };
            
            for (const [category, keywords] of Object.entries(categoryKeywords)) {
                if (keywords.some(keyword => text.includes(keyword))) {
                    return category;
                }
            }
            
            return null;
        }

        function showLookupStatus(message, type) {
            const statusDiv = document.getElementById('lookupStatus');
            statusDiv.textContent = message;
            statusDiv.className = `lookup-${type}`;
            statusDiv.style.display = 'block';
            
            // Hide after 5 seconds unless it's an error
            if (type !== 'error') {
                setTimeout(() => {
                    statusDiv.style.display = 'none';
                }, 5000);
            }
        }
    </script>
</body>
</html>
