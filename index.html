<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FRZR - Freezer Management</title>

```
<!-- PWA Meta Tags -->
<meta name="theme-color" content="#4F46E5">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="FRZR">
<meta name="description" content="Smart freezer inventory management app">

<!-- PWA Icons -->
<link rel="icon" type="image/png" sizes="192x192" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>❄️</text></svg>">
<link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>❄️</text></svg>">

<!-- Tailwind CSS -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- Material Icons -->
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<style>
    body { 
        font-family: 'Inter', sans-serif; 
    }
    
    .material-icons { 
        font-family: 'Material Icons'; 
    }
    
    .fab {
        position: fixed;
        bottom: 24px;
        right: 24px;
        z-index: 1000;
        box-shadow: 0 8px 24px rgba(79, 70, 229, 0.3);
    }
    
    .fab-secondary {
        bottom: 100px;
        background-color: #6B7280;
        box-shadow: 0 6px 20px rgba(107, 114, 128, 0.3);
    }
    
    .scanner-overlay {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 280px;
        height: 180px;
        border: 3px solid #4F46E5;
        border-radius: 12px;
        pointer-events: none;
        box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.5);
    }
    
    .hidden {
        display: none;
    }
    
    .show {
        display: block;
    }
</style>
```

</head>
<body class="bg-gray-50 font-sans">
    <!-- Header -->
    <header class="bg-indigo-600 text-white shadow-lg sticky top-0 z-50">
        <div class="max-w-md mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-white bg-opacity-20 rounded-full flex items-center justify-center">
                        <span class="text-2xl">❄️</span>
                    </div>
                    <h1 class="text-2xl font-semibold">FRZR</h1>
                </div>
                <div class="flex space-x-2">
                    <button id="stats-btn" class="w-10 h-10 bg-white bg-opacity-20 rounded-full flex items-center justify-center hover:bg-opacity-30 transition-all">
                        <span class="material-icons text-xl">bar_chart</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

```
<!-- Expiration Alert -->
<div id="expiration-alert" class="bg-orange-100 border-l-4 border-orange-500 p-4 mx-4 mt-4 hidden">
    <div class="flex items-center">
        <span class="material-icons text-orange-600 mr-3">warning</span>
        <span id="expiration-text" class="text-orange-800 font-medium"></span>
    </div>
</div>

<!-- Main Content -->
<main class="max-w-md mx-auto p-4 pb-32">
    <!-- Search and Filters -->
    <div class="bg-white rounded-lg shadow-sm p-4 mb-4 border border-gray-200">
        <div class="relative mb-4">
            <span class="material-icons absolute left-3 top-3 text-gray-400">search</span>
            <input 
                type="text" 
                id="search-input"
                placeholder="Search items..." 
                class="w-full pl-11 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all"
            >
        </div>
        
        <div class="grid grid-cols-2 gap-3">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Category</label>
                <select id="category-filter" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none">
                    <option value="All">All</option>
                    <option value="Meat">Meat</option>
                    <option value="Vegetables">Vegetables</option>
                    <option value="Fruits">Fruits</option>
                    <option value="Dairy">Dairy</option>
                    <option value="Prepared Meals">Prepared Meals</option>
                    <option value="Desserts">Desserts</option>
                    <option value="Other">Other</option>
                </select>
            </div>
            
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Sort by</label>
                <select id="sort-select" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none">
                    <option value="expiration">Expiration</option>
                    <option value="name">Name</option>
                    <option value="quantity">Quantity</option>
                    <option value="dateAdded">Date Added</option>
                </select>
            </div>
        </div>
    </div>

    <!-- Items Container -->
    <div id="items-container" class="space-y-3">
        <!-- Items will be dynamically inserted here -->
    </div>

    <!-- Empty State -->
    <div id="empty-state" class="text-center py-16 hidden">
        <span class="material-icons text-6xl text-gray-300 mb-4">inventory_2</span>
        <p class="text-gray-500 text-xl font-medium mb-2">No items found</p>
        <p class="text-gray-400">Try scanning food or adding items manually</p>
    </div>
</main>

<!-- Floating Action Buttons -->
<button id="manual-add-btn" class="fab fab-secondary w-14 h-14 rounded-full flex items-center justify-center hover:scale-105 transition-transform">
    <span class="material-icons text-white text-xl">edit</span>
</button>

<button id="scan-btn" class="fab bg-indigo-600 w-16 h-16 rounded-full flex items-center justify-center hover:scale-105 transition-transform">
    <span class="material-icons text-white text-2xl">qr_code_scanner</span>
</button>

<!-- Barcode Scanner Modal -->
<div id="scanner-modal" class="fixed inset-0 bg-black z-50 hidden">
    <div class="relative h-full">
        <video id="scanner-video" autoplay muted playsinline class="w-full h-full object-cover"></video>
        <div class="scanner-overlay"></div>
        
        <!-- Scanner Controls -->
        <div class="absolute top-0 left-0 right-0 p-6 bg-gradient-to-b from-black to-transparent">
            <div class="flex items-center justify-between text-white">
                <button id="close-scanner" class="flex items-center space-x-2 bg-black bg-opacity-50 px-4 py-2 rounded-lg">
                    <span class="material-icons">close</span>
                    <span>Cancel</span>
                </button>
                <button id="manual-entry-btn" class="bg-black bg-opacity-50 px-4 py-2 rounded-lg text-sm font-medium">
                    Manual Entry
                </button>
            </div>
        </div>
        
        <div class="absolute bottom-0 left-0 right-0 p-6 bg-gradient-to-t from-black to-transparent">
            <div class="text-center">
                <p class="text-white text-lg font-medium mb-2">Point camera at barcode</p>
                <div id="scan-status" class="text-white text-sm opacity-75">Scanning for barcodes...</div>
            </div>
        </div>
    </div>
</div>

<!-- Add Item Modal -->
<div id="add-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 hidden">
    <div class="bg-white rounded-lg shadow-2xl w-full max-w-sm max-h-[90vh] overflow-y-auto">
        <div class="px-6 py-4 border-b border-gray-200">
            <div class="flex items-center space-x-2">
                <span id="add-modal-icon" class="material-icons text-indigo-600">edit</span>
                <h2 id="add-modal-title" class="text-xl font-medium text-gray-900">Add Item</h2>
            </div>
        </div>
        
        <form id="add-item-form" class="p-6 space-y-4">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Item Name *</label>
                <input 
                    type="text" 
                    id="item-name"
                    required
                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none"
                    placeholder="Enter food name"
                >
            </div>
            
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Category</label>
                <select id="item-category" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none">
                    <option value="Meat">Meat</option>
                    <option value="Vegetables">Vegetables</option>
                    <option value="Fruits">Fruits</option>
                    <option value="Dairy">Dairy</option>
                    <option value="Prepared Meals">Prepared Meals</option>
                    <option value="Desserts">Desserts</option>
                    <option value="Other">Other</option>
                </select>
            </div>
            
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Quantity</label>
                <input 
                    type="number" 
                    id="item-quantity"
                    min="1" 
                    value="1"
                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none"
                >
            </div>
            
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Expiration Date *</label>
                <input 
                    type="date" 
                    id="item-expiration"
                    required
                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none"
                >
            </div>

            <div id="barcode-info" class="bg-indigo-50 p-3 rounded-lg hidden">
                <div class="flex items-center space-x-2">
                    <span class="material-icons text-indigo-600 text-sm">qr_code</span>
                    <span id="barcode-text" class="text-sm font-medium text-indigo-900"></span>
                </div>
            </div>
            
            <div id="manual-barcode-section" class="hidden">
                <label class="block text-sm font-medium text-gray-700 mb-2">Or Enter Barcode Manually</label>
                <div class="flex space-x-2">
                    <input 
                        type="text" 
                        id="manual-barcode-input"
                        placeholder="Enter barcode number"
                        class="flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none"
                    >
                    <button 
                        type="button"
                        id="lookup-barcode-btn"
                        class="px-4 py-3 bg-indigo-100 text-indigo-600 rounded-lg hover:bg-indigo-200 transition-colors font-medium"
                    >
                        Lookup
                    </button>
                </div>
            </div>
        </form>
        
        <div class="px-6 py-4 bg-gray-50 rounded-b-lg flex space-x-3">
            <button id="cancel-add" type="button" class="flex-1 px-4 py-3 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors font-medium">
                Cancel
            </button>
            <button id="confirm-add" type="submit" form="add-item-form" class="flex-1 px-4 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors font-medium">
                Add Item
            </button>
        </div>
    </div>
</div>

<!-- Statistics Modal -->
<div id="stats-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 hidden">
    <div class="bg-white rounded-lg shadow-2xl w-full max-w-sm max-h-[80vh] overflow-y-auto">
        <div class="px-6 py-4 border-b border-gray-200">
            <h2 class="text-xl font-medium text-gray-900">Freezer Statistics</h2>
        </div>
        
        <div class="p-6 space-y-6">
            <div class="grid grid-cols-2 gap-4">
                <div class="bg-indigo-50 p-4 rounded-lg text-center">
                    <div id="total-items" class="text-3xl font-bold text-indigo-600">0</div>
                    <div class="text-sm font-medium text-gray-600">Total Items</div>
                </div>
                <div class="bg-green-50 p-4 rounded-lg text-center">
                    <div id="total-quantity" class="text-3xl font-bold text-green-600">0</div>
                    <div class="text-sm font-medium text-gray-600">Total Quantity</div>
                </div>
            </div>
            
            <div>
                <h3 class="font-medium text-gray-900 mb-3">By Category</h3>
                <div id="category-stats" class="space-y-2">
                    <!-- Category stats will be inserted here -->
                </div>
            </div>
            
            <div>
                <h3 class="font-medium text-gray-900 mb-3">Expiration Alerts</h3>
                <div class="bg-orange-50 p-4 rounded-lg border border-orange-200">
                    <div id="expiring-count" class="text-2xl font-bold text-orange-600">0</div>
                    <div class="text-sm font-medium text-gray-600">Items expiring within 30 days</div>
                </div>
            </div>
        </div>
        
        <div class="px-6 py-4 bg-gray-50 rounded-b-lg">
            <button id="close-stats" class="w-full px-4 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors font-medium">
                Close
            </button>
        </div>
    </div>
</div>

<script>
    // FRZR Web App JavaScript - Clean Implementation
    class FRZRApp {
        constructor() {
            // Initialize data
            this.items = this.loadItems();
            this.currentBarcode = null;
            this.scanner = null;
            this.searchTerm = '';
            this.categoryFilter = 'All';
            this.sortBy = 'expiration';
            this.isScanning = false;
            
            // Initialize app
            this.init();
        }
        
        loadItems() {
            try {
                const stored = localStorage.getItem('frzr-items');
                if (stored) {
                    return JSON.parse(stored);
                }
            } catch (error) {
                console.error('Error loading items:', error);
            }
            
            // Default sample data
            return [
                {
                    id: 1,
                    name: "Ground Beef",
                    quantity: 2,
                    dateAdded: "2025-08-15",
                    expirationDate: "2025-12-15",
                    category: "Meat",
                    favorite: true,
                    barcode: "123456789012"
                },
                {
                    id: 2,
                    name: "Frozen Berries",
                    quantity: 1,
                    dateAdded: "2025-08-10",
                    expirationDate: "2026-02-10",
                    category: "Fruits",
                    favorite: false,
                    barcode: null
                }
            ];
        }
        
        saveItems() {
            try {
                localStorage.setItem('frzr-items', JSON.stringify(this.items));
            } catch (error) {
                console.error('Failed to save items:', error);
                this.showToast('Warning: Could not save data');
            }
        }
        
        init() {
            this.setupEventListeners();
            this.setupPWA();
            this.renderItems();
            this.updateExpirationAlert();
            
            console.log('FRZR initialized successfully with', this.items.length, 'items');
        }
        
        setupEventListeners() {
            // FAB buttons
            document.getElementById('scan-btn').addEventListener('click', () => this.startScanning());
            document.getElementById('manual-add-btn').addEventListener('click', () => this.showAddModal(false));
            
            // Modal controls
            document.getElementById('close-scanner').addEventListener('click', () => this.stopScanning());
            document.getElementById('manual-entry-btn').addEventListener('click', () => {
                this.stopScanning();
                this.showAddModal(false);
            });
            document.getElementById('cancel-add').addEventListener('click', () => this.hideAddModal());
            document.getElementById('add-item-form').addEventListener('submit', (e) => this.addItem(e));
            document.getElementById('lookup-barcode-btn').addEventListener('click', () => this.lookupManualBarcode());
            
            // Stats modal
            document.getElementById('stats-btn').addEventListener('click', () => this.showStatsModal());
            document.getElementById('close-stats').addEventListener('click', () => this.hideStatsModal());
            
            // Search and filters
            document.getElementById('search-input').addEventListener('input', (e) => {
                this.searchTerm = e.target.value;
                this.renderItems();
            });
            
            document.getElementById('category-filter').addEventListener('change', (e) => {
                this.categoryFilter = e.target.value;
                this.renderItems();
            });
            
            document.getElementById('sort-select').addEventListener('change', (e) => {
                this.sortBy = e.target.value;
                this.renderItems();
            });
        }
        
        setupPWA() {
            // PWA install prompt
            let deferredPrompt;
            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;
                // Could show install prompt here
            });
        }
        
        async startScanning() {
            console.log('Starting camera...');
            
            if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
                alert('Camera not supported. Please use manual entry.');
                this.showAddModal(false);
                return;
            }
            
            try {
                const stream = await navigator.mediaDevices.getUserMedia({
                    video: { 
                        facingMode: 'environment',
                        width: { ideal: 1920 },
                        height: { ideal: 1080 }
                    }
                });
                
                const video = document.getElementById('scanner-video');
                video.srcObject = stream;
                
                await new Promise((resolve) => {
                    video.onloadedmetadata = () => {
                        video.play();
                        resolve();
                    };
                });
                
                document.getElementById('scanner-modal').classList.remove('hidden');
                this.isScanning = true;
                
                // Start mock scanning (replace with real barcode library)
                this.startMockScanning();
                
            } catch (error) {
                console.error('Camera error:', error);
                alert('Camera access failed. Please use manual entry.');
                this.showAddModal(false);
            }
        }
        
        startMockScanning() {
            const mockBarcodes = [
                '123456789012',
                '234567890123', 
                '345678901234',
                '456789012345'
            ];
            
            const scanInterval = setInterval(() => {
                if (!this.isScanning) {
                    clearInterval(scanInterval);
                    return;
                }
                
                // Simulate finding a barcode occasionally
                if (Math.random() > 0.98) {
                    const barcode = mockBarcodes[Math.floor(Math.random() * mockBarcodes.length)];
                    this.handleBarcodeFound(barcode);
                    clearInterval(scanInterval);
                }
            }, 100);
        }
        
        handleBarcodeFound(barcode) {
            console.log('Barcode found:', barcode);
            document.getElementById('scan-status').textContent = 'Barcode found!';
            
            if (navigator.vibrate) {
                navigator.vibrate(200);
            }
            
            setTimeout(() => {
                this.currentBarcode = barcode;
                this.stopScanning();
                this.lookupProduct(barcode);
            }, 1000);
        }
        
        stopScanning() {
            this.isScanning = false;
            
            const video = document.getElementById('scanner-video');
            if (video && video.srcObject) {
                const tracks = video.srcObject.getTracks();
                tracks.forEach(track => track.stop());
                video.srcObject = null;
            }
            
            document.getElementById('scanner-modal').classList.add('hidden');
        }
        
        async lookupProduct(barcode) {
            console.log('Looking up product for barcode:', barcode);
            
            // Mock product database
            const products = {
                '123456789012': { name: 'Organic Ground Turkey', category: 'Meat' },
                '234567890123': { name: 'Frozen Mixed Vegetables', category: 'Vegetables' },
                '345678901234': { name: 'Premium Ice Cream', category: 'Desserts' },
                '456789012345': { name: 'Chicken Breast', category: 'Meat' }
            };
            
            const product = products[barcode];
            
            // Pre-fill form
            document.getElementById('item-name').value = product ? product.name : '';
            document.getElementById('item-category').value = product ? product.category : 'Other';
            document.getElementById('barcode-text').textContent = 'Barcode: ' + barcode;
            document.getElementById('barcode-info').classList.remove('hidden');
            document.getElementById('add-modal-title').textContent = 'Scanned Item';
            document.getElementById('add-modal-icon').textContent = 'qr_code_scanner';
            
            this.showAddModal(true);
        }
        
        lookupManualBarcode() {
            const barcode = document.getElementById('manual-barcode-input').value.trim();
            if (barcode && barcode.length >= 8) {
                this.currentBarcode = barcode;
                this.lookupProduct(barcode);
                document.getElementById('manual-barcode-section').classList.add('hidden');
            } else {
                alert('Please enter a valid barcode (8+ digits)');
            }
        }
        
        showAddModal(isScanned) {
            if (!isScanned) {
                document.getElementById('add-modal-title').textContent = 'Add Item Manually';
                document.getElementById('add-modal-icon').textContent = 'edit';
                document.getElementById('barcode-info').classList.add('hidden');
                document.getElementById('manual-barcode-section').classList.remove('hidden');
                this.currentBarcode = null;
            }
            
            document.getElementById('add-modal').classList.remove('hidden');
            document.getElementById('item-name').focus();
        }
        
        hideAddModal() {
            document.getElementById('add-modal').classList.add('hidden');
            document.getElementById('add-item-form').reset();
            document.getElementById('barcode-info').classList.add('hidden');
            document.getElementById('manual-barcode-section').classList.add('hidden');
            document.getElementById('manual-barcode-input').value = '';
            this.currentBarcode = null;
        }
        
        addItem(e) {
            e.preventDefault();
            
            const name = document.getElementById('item-name').value.trim();
            const category = document.getElementById('item-category').value;
            const quantity = parseInt(document.getElementById('item-quantity').value) || 1;
            const expirationDate = document.getElementById('item-expiration').value;
            
            if (!name || !expirationDate) {
                alert('Please fill in all required fields');
                return;
            }
            
            const item = {
                id: Date.now(),
                name: name,
                category: category,
                quantity: quantity,
                expirationDate: expirationDate,
                dateAdded: new Date().toISOString().split('T')[0],
                favorite: false,
                barcode: this.currentBarcode
            };
            
            this.items.push(item);
            this.saveItems();
            this.renderItems();
            this.updateExpirationAlert();
            this.hideAddModal();
            
            this.showToast('Added ' + name + ' to freezer');
        }
        
        updateQuantity(id, delta) {
            this.items = this.items.map(item => {
                if (item.id === id) {
                    const newQuantity = Math.max(0, item.quantity + delta);
                    return newQuantity === 0 ? null : Object.assign({}, item, { quantity: newQuantity });
                }
                return item;
            }).filter(Boolean);
            
            this.saveItems();
            this.renderItems();
            this.updateExpirationAlert();
        }
        
        toggleFavorite(id) {
            this.items = this.items.map(item => 
                item.id === id ? Object.assign({}, item, { favorite: !item.favorite }) : item
            );
            this.saveItems();
            this.renderItems();
        }
        
        deleteItem(id) {
            if (confirm('Are you sure you want to delete this item?')) {
                this.items = this.items.filter(item => item.id !== id);
                this.saveItems();
                this.renderItems();
                this.updateExpirationAlert();
            }
        }
        
        getDaysUntilExpiration(expirationDate) {
            const today = new Date();
            const expDate = new Date(expirationDate);
            const diffTime = expDate - today;
            return Math.ceil(diffTime / (1000 * 60 * 60 * 24));
        }
        
        getExpirationStatus(expirationDate) {
            const days = this.getDaysUntilExpiration(expirationDate);
            if (days < 0) return { status: 'expired', color: 'text-red-600 bg-red-50 border-red-200', text: 'Expired' };
            if (days <= 30) return { status: 'warning', color: 'text-orange-600 bg-orange-50 border-orange-200', text: days + ' days left' };
            return { status: 'good', color: 'text-green-600 bg-green-50 border-green-200', text: days + ' days left' };
        }
        
        getFilteredAndSortedItems() {
            const self = this;
            return this.items
                .filter(function(item) {
                    const matchesSearch = item.name.toLowerCase().includes(self.searchTerm.toLowerCase());
                    const matchesCategory = self.categoryFilter === 'All' || item.category === self
```
